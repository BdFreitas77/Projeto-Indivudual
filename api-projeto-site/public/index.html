<!DOCTYPE html>
<html lang="pt-Br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/homepage.css">
    <script src="script/script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script> -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.0.0-rc.1/chartjs-plugin-datalabels.min.js">
    </script>
    <title>Página Inicial</title>
</head>

<body onload=obterDadosGraficoPrimeiraVez()>

    <section id="sec_home" class="sec_one">
        <div class="conteiner_header">
            <div class="header">
                <img class="logo" src="./images/logo.png" alt="">
                <nav>
                    <ul>
                        <li>
                            <a href="#sec_home">HOME</a>
                        </li>
                        <li>
                            <a href="#sec_sobre">SOBRE</a>
                        </li>
                        <li>
                            <a href="#sec_contato">CONTATO</a>
                        </li>
                        <li>
                            <a href="login_cadastro.html">LOGIN / CADASTRO</a>
                        </li>
                        <li>
                            <a href="https://newaccount1621527364544.freshdesk.com/support/tickets/new">SUPORTE</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>

        <div class="conteiner_apresentacao">
            <div class="title">
                <span id="lower_text">não seja mais</span> <br>
                <span">ESCRAVO DE SUA MENTE</span>
                    <br>
                    <button onclick="saiba_mais()">saiba mais!</button>
            </div>

        </div>
    </section>
    <section id="sec_sobre" class="sec_two">
        <div class="conteiner_sobre">
            <h1>Seja muito bem vindo!</h1>
            <div class="questions">
                <div class="quem_sou">
                    <h3>Quem sou ?</h3>
                    <div id="foto">
                        <img src="./images/eu.jfif" alt="">
                    </div>
                    <div class="qmsou_text">
                        <span>
                            Meu nome é Breno de Freitas, tenho 17 anos e adivinha ? A coisa que eu mais amo fazer nesse
                            mundo, é meditar, me conectar comigo mesmo, com a paz e com o momento presente. Ano passado,
                            2020, foi o pior ano da minha vida, onde passei por uma depressão profunda, onde eu não
                            enxergava sentido em absolutamente nada... Eu estava completamente perdido. Sempre fui muito
                            tímido e ansioso, sempre pensava muito em qualquer coisa que eu fosse fazer, vivia me
                            cobrando
                            a todo momendo e a minha mente vivia a mil por hora... Mas, quando eu descobri a arte de
                            ser,
                            quando comecei a estudar o comportamento da mente humana, após um ano meditando todos os
                            dias
                            consegui me curar completamente, atingindo o despertar espiritual. O que ninguém sabe, é que
                            meditar é a coisa mais fácil do mundo.
                        </span>
                    </div>

                </div>
                <div class="meditacao">
                    <div>
                        <h3>Mas afinal, o que é meditação?</h3>
                        <div class="meditacao_text">
                            <span>
                                Muita gente vive falando: "Ah, meditacão não é pra mim! Não consigo focar!"; "Odeio
                                meditar, não gosto de ficar parado!"; "Exige muita técnica, não consigo!"; "Não consigo
                                ficar com coluna reta e na posição de lotus!"... Mal sabem
                                elas que estão totalmente erradas e que meditação é, simplesmente, fazer NADA. Sim, é
                                fazer absolutamente nada, é estar apenas existindo, ou melhor, apenas "sendo", como
                                muitos mestres falam. <br>
                                Segundo o mestre Osho, meditação não é uma ação, que é impossível praticá-la, que a
                                única coisa que deve ser feita, é entendê-la... Ele diz que meditação é o momento em que
                                todo o esforço cessa, onde você aceita tudo o que esteja acontecendo, seja agradável ou
                                desagradável e, sem julgar ou impedir... <br>
                                Muitos acham que na meditação, você deve focar em algo, seja na respiração ou nos
                                barulhos a sua volta, mas isso só atrapalha, pois o foco é uma ação da mente e a
                                meditação é além da mente ! É muito além, não é necessário nenhum esforço para
                                alcançá-la, basta silenciar-se e permitir que o silencio o consuma.
                            </span>
                        </div>
                    </div>
                </div>
                <div class="frases">
                    <div>
                        <h3>Algumas frases para refletir</h3>
                        <div class="frases_text">
                            <span>
                                -"No momento em que você busca a paz, ela já não existe mais" _Osho. <br><br>
                                -"Relaxe, nada está sob controle" _Osho. <br><br>
                                -"Nada vai embora até nos ensinar o que temos que aprender" _Buda. <br><br>
                                -"Até a mente mais positiva que você conhece tem pensamentos negativos. A questão é não
                                alimentá-los" _@Decretos.quantidos(instagram). <br><br>
                                -"Quem não se encaixa no mundo, está mais perto de encontrar a si mesmo." _Herman Hesse
                                <br><br>
                                -"A maior liberdade é ser livre da nossa própria mente" _Osho. <br><br>
                                -"A jornada interior começa quando você percebe que absolutamente nada no exterior vai
                                lhe trazer felicidade" _Osho.
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div style="display: inline-block;">
                <h1 style="text-transform: uppercase; text-decoration: underline; margin: 20px 0 55px 0;">Sobre os
                    usuários desse site:</h1>
                    <div id="grafico">
                        <canvas id="myChart" style="height: 600px;"></canvas>
                    </div>
            </div>
        </div>
    </section>

    <section id="sec_contato" class="sec_three">
        <div class="conteiner_contato">
            <div class="box_contato">
                <div id="contato">
                    <div class="text">
                        Quer um curso de meditação 100% gratuito? <br>
                        <u class="msg">Entre em contato!</u>
                    </div>
                    <div class="box_informations">
                        <form id="form_curso" method="post" onsubmit="return eu_quero()">
                            <div class="selecione">
                                Selecione o que você gostaria de receber via e-mail:
                                <br>
                                <br>
                                <br>
                                <input type="checkbox" id="check_um" value="links_youtube" name="ytb"> Link de vídeos do
                                youtube.
                                <br>
                                <br>
                                <br>
                                <input type="checkbox" id="check_dois" value="pdfs_livros" name="pdf"> Pdfs de livros.
                                <br>
                                <br>
                                <br>
                                <input type="checkbox" id="check_tres" value="pag_insta" name="insta"> Páginas do
                                instagram.
                            </div>
                            <div class="insira">
                                Insira seu e-mail:
                                <br>
                                <br>
                                <br>
                                <input id="input_text_um" type="text" name="email_curso">
                                <br><br><br>
                                Confirme seu e-mail:
                                <br><br><br>
                                <input id="input_text_dois" type="text">
                            </div>
                            <div class="separar"></div>
                            <button id="btn_entrar" onclick="eu_quero()">EU QUERO!</button>
                        </form>
                    </div>
                </div>

                <div id="contato_resultado" style="display: none;">
                    <div class="text_result">
                        Muito obrigado ! <br> Entraremos em contato em até 24 horas !
                    </div>
                    <div class="list">
                        <u>Nesse curso, você aprenderá:</u> <br>
                        - O funcionamento da mente. <br>
                        - O que é a matrix e como sair dela. <br>
                        - Como lidar com a mente. <br>
                        - Sua verdadeira essência e natureza. <br>
                        - Tudo sobre meditação.
                    </div>
                    <div class="text_result">
                        Faça seu <a href="login_cadastro.html"><u>login/cadastro</u></a> para conversar com os
                        meditadores usuários deste site!
                    </div>
                </div>
            </div>
            <div class="rodape">
                <br>
                Copyright © 2021 | feito por Breno de Freitas
            </div>
        </div>
    </section>
</body>

</html>
<script>
    var contador = 0;
    while (contador >= 5) {
        obterDadosGraficoPrimeiraVez()
        contador++
    }
    function eu_quero() {
        if (input_text_um.value.indexOf("@") > input_text_um.value.indexOf(".com") || input_text_um.value == "" ||
            input_text_um.value.indexOf("@") == "-1") {
            alert("Insira um e-mail válido, por favor !")
        } else if (input_text_um.value != input_text_dois.value) {
            alert("e-mails NÃO coincidem ! Tente novamente !")
        } else if (check_um.checked || check_dois.checked || check_tres.checked) {

            if (check_um.checked) {
                check_um.value = 'sim';
            } else {
                check_um.value = 'nao'
            }
            if (check_dois.checked) {
                check_dois.value = 'sim';
            } else {
                check_dois.value = 'nao'
            }
            if (check_tres.checked) {
                check_tres.value = 'sim';
            } else {
                check_tres.value = 'nao'
            }

            aguardar();
            var formulario = new URLSearchParams(new FormData(form_curso));
            fetch("/index/enviar_curso", {
                method: "POST",
                body: formulario
            }).then(function (response) {

                if (response.ok) {

                    contato.style.display = "none";
                    contato_resultado.style.display = "block";

                } else {

                    console.log('Erro de cadastro!');
                    response.text().then(function (resposta) {
                        alert(`${resposta}:`)
                    });
                    finalizar_aguardar();
                }
            });

            return false;
        } else {
            alert("Selecione pelo menos uma das caixinhas !")
        }
    }

    function aguardar() {
        btn_entrar.disabled = true;
        // div_erro.style.display = 'none';
    }

    function finalizar_aguardar() {
        btn_entrar.disabled = false;
        // div_erro.style.display = 'block';
        // alert(`${resp}`)
    }


    // function cadastrar() {
    //     if (senha_cadastro.value.length < 8 || senha_cadastro.value.length > 16) {
    //         alert("Senhas devem possuir, no mínimo, 8 caracteres e no máximo 16.")
    //     } else if (senha_cadastro.value != confirme_senha.value) {
    //         alert("Senhas não conferem, tente novamente!")
    //     } else {

    // var ctx = document.getElementById('myChart').getContext('2d');
    // var myChart = new Chart(ctx, {
    //     type: 'pie',
    //     data: {
    //         labels: [
    //             'Meditadores Iniciantes',
    //             'Meditadores Experientes'
    //         ],
    //         datasets: [{
    //             label: 'My First Dataset',
    //             data: [1, 5],
    //             backgroundColor: [
    //                 'Purple',
    //                 'Pink'
    //             ],
    //             hoverOffset: 4
    //         }]
    //     },
    //     options: {
    //             plugins: {
    //                 datalabels: {
    //                     formatter: function (value, context) {
    //                         return context.chart.data.labels[
    //                             context.dataIndex
    //                         ];
    //                     },
    //                 },
    //             },
    //         },
    // });
 
    

    function gerar_grafico() {
            var ctx = document.getElementById('myChart').getContext('2d');
            var myChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Meditadores Iniciantes', 'Meditadores Experientes'],
                    datasets: [{
                        label: '# of Votes',
                        data: [iniciantes, experientes],
                        backgroundColor: [
                            'pink',
                            'purple'
                        ],
                        borderColor: [
                            'white'
                        ],
                        borderWidth: 1
                    }]
                },
            });
        }

    // var resposta = '';

    var iniciantes = 0;
    var experientes = 0;


    function obterDadosGraficoPrimeiraVez() {
        console.log("executei obterDadosGraficoPrimeiraVez")
        // alterarCoresBotoes(idcaminhao);

        // if (proximaAtualizacao != undefined) {
        //     clearTimeout(proximaAtualizacao);
        // }

        fetch(`/leituras/ultimas/`, {
                cache: 'no-store'
            }).then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        // alert(resposta);
                        // resposta.reverse();
                        // var iniciante_true = '';
                        // iniciante_true = iniciante;
                        // grafico = [];
                        // grafico.push(resposta.iniciantes)
                        // console.log(resposta.iniciantes);
                        iniciantes = Number(resposta.length);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });


            fetch(`/leituras/total/`, {
                cache: 'no-store'
            }).then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        // alert(resposta);
                        // resposta.reverse();
                        // var iniciante_true = '';
                        // iniciante_true = iniciante;
                        // grafico = [];
                        // grafico.push(resposta.iniciantes)
                        // console.log(resposta.iniciantes);
                        experientes = Number(resposta.length) - Number(iniciantes);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
            


            // gerar_grafico()
        }
        
        setTimeout(() => obterDadosGraficoPrimeiraVez(), 1000)
        setTimeout(() => gerar_grafico(), 1200)

</script>